### 模型假设

联络线支持双向供电，其他供电线路仅支持单向供电。



### 模型的建立--双供配电网模型

（1）双供配电网的网络拓扑图

在（1）（2）问中，以建造费用为唯一优化目标设计的单供网络，具有树状结构，且仅支持单向供电，否则会导致更高的成本。而双供配电网络，是在前者基础上增加联络线而来，目的是控制成本的情况下提高网络中用户用电的可靠性。

本文假定两个单供网络的地位是等价的，联络线支持双向供电，考虑由此带来工程难度的增加，定义联络线单位造价为主线的2倍，且每个方向均需设置开关。

$cost_{link}=2cost_{circuit}(1)$

设联络线的端点为联络点，联络点属于两个单供配电网的分叉点。两个单供网络分叉点集合分别为$K_1$，$K_2$，设联络线$L_{cont}=(u,v)$，则有$u\in K_1$且$v\in K_2$，即

$(u,v)\in \{L_{cont}\}:u\in K_1,v\in K_2$

根据前面假设“每个电源只有一条主线出线”，可以进一步抽象出双供配电网络主干部分的拓扑图，首先，每个单供网络仅保留电源、主线以及主线上的分叉点。其次，选择分叉点设置联络点，并在联络点之间建立联络线。由此，得到双供配电网的网络拓扑图如下

![image-20221119203615273](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20221119203615273.png)

在使用联络线进行扩展供电时，不应出现支线为主线的上一级线路，这要求**联络点必须设置在主线上**，因此仅保留主线上的分叉点。正常情况下，联络线上联络开关$s_{c1}$，$s_{c2}$断开，一旦发生主线某部分故障，如上图所示处，线路发生故障，此时可行调度方案为（假设电源$B_1$可扩供所有故障节点）$s_{m}$断开，$s_{c1}$闭合，电源$B_1$通过左侧联络线为故障点后所有用户供电。

而配电网的**支线部分发生故障**，并没有相应的调度方案。这符合我们的一般认知，双供调度是为解决区域内一定规模的用户用电故障问题。对于影响较小的故障，问题排查容易，恢复时间快，调度带来效益不高！

（2）用电可靠性精确概率模型

为论述概率模型的思想，本部分以下图所描述的情况作为例子讲述，为简化图省略线路开关。

![image-20221119152120159](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20221119152120159.png)

不同于单供网络，双供网络由于多条联络线，存在多个扩展供电方案。设供电路径$P=(p_1,p_2,..,p_n)$，其中$p_i$为子路径。用字母$a-g$表示子路径的可靠性（为了方便表达有时可指代路径本身），如字母$a$表示从电源出发一直到首个联络点（不包含该联络点）之间路径的可靠性。假设目前需求解最右下角节点$i$的可靠性$r_i$，观察到存在$(a,c,f,g)$和$(a,b,d,g)$，两条条电源$B_1$扩展供电路径，以及原先单供网络电源$B_2$的供电路径$(e,f,g)$，容易得到每条路径的可靠性：

$r_1=r(a,c,f,g)=acfg$，$r_2=r(a,b,d,g)=abdg$，$r_3=r(e,f,g)=efg$

由于路径相互重叠，它们之间的可靠性不是相互独立的，如$r((a,c,f,g)\cap(a,b,d,g))\neq r(a,c,f,g)\times r(a,b,d,g)$，但可以用两条路径包含的所有子路径可靠性之积表达，子路径之间是相互独立的！

$r((a,c,f,g)\cap(a,b,d,g))=\prod_{p\in (a,c,f,g)\cup(a,b,d,g)} r(p)=acfgbd$

进一步，可通过**容斥原理**计算存在$(a,c,f,g)$和$(a,b,d,g)$两条供电线路时的节点的可靠性$r_{12}$：

$r_{12}=r((a,c,f,g)\cup (a,b,d,g))=r(a,c,f,g)+r(a,b,d,g)-r((a,c,f,g)\cap (a,b,d,g))=ag\times (bd+cf-bdcf)$

同理，$r_{13}=g\times (abd+ef-abdef)$，$r_{23}=fg\times (ac+e-ace)$

进而3条供电路径可根据3元容斥原理计算$r_{i}$：

![image-20221119193845405](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20221119193845405.png)

$r_{i}=r_{123}=acfg+abdg+efg-acfgbd-acfge-abdgef+abcdefg$

以上讨论，可进一步拓展至$n$条供电路径的情况。设对于目标供电节点$i$，存在供电路径集合$P=\{P_1,P_2,...,P_n\}$，现求节点$i$的用电可靠性$r_i$。相应地，应用$n$元容斥原理：

$r_i=r(P_1\cup P_2 \cup ...\cup P_n)=\sum r(P_i)-\sum r(P_i \cap P_j)+\sum r(P_i \cap P_j \cap P_k)-...+(-1)^{n-1}r(P_1\cap P_2 \cap ... \cap P_n)$

设$a_i\in\{1,2,...,n\}$且$\forall i\neq j$，有$a_i\neq a_j$，则$m(m\leq n)$条供电路径$\{{P_{a_1}},{P_{a_2},...,{P_{a_m}}}\}$同时可靠的概率描述为

$r(P_{a_1}\cap P_{a_2}\cap...\cap P_{a_m})=\prod_{p\in \{P_{a_i}|i=1,2,...,m\}}r(p)$

其中$p\in \{P_{a_i}|i=1,2,...,m\}$为最小子路径，相互独立。

（3）基于具体调度方案的用电可靠性刻画

根据双供配电网用户供电调度原则第（1）点，满足一个用户全部需求功率，否则断开该用户，以及配电网规划的实际过程，并不是设置联络线后就为**所有故障后可恢复用户**均准备供电调度方案（如在（1）部分最后的调度方案），一方面受限于电源的可扩展供电量和扩供成本，另一方面有些用户本身用电可靠性较高，失电于它们是小概率事件，而本问中优化目标为可控成本下提高最低的用电可靠性，因此这些用户并不是首要的优化目标，甚至不是优化目标。

因此，设节点$i$备有调度方案的供电路径集合$P'=\{P_1',P_2',...,P_m'\}$，$|P'|=m$，且满足约束$P' \subseteq P$，节点$i$的用电可靠性刻画为

$r_i=r(P_1'\cup P_2' \cup ...\cup P_m')$

（4）联络线的设置约束

首先，本文认为联络线的设置至少满足：

<1> 每个联络点仅和一条联络线相关；

<2> 联络线之间不存在相互重叠的情况；

否则，设想$|K_1|\times |K_2|$条联络线的情况，如下图，此时双供网络之间的联系甚至强于自身网络，联络线的作用已经不仅仅是联络，而是构建了一个新网络。即使是在成本允许的情况下这也不能被允许！

![image-20221120140718387](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20221120140718387.png)

对于第<2>点，城市中配电电缆往往铺设在地下空间，线路重叠意味着施工深度的增加，与其他建设管道冲突可能性的提升。因此，规划时保证联络线不重叠。

如何保证以上约束？在所有联络线构成的集合$\{L_{cont}\}$中，对于任意两条不同联络线$(u_i,v_i)$和$(u_j,v_j)$，$i\neq j$，有$u_i\neq u_j$，$v_i\neq v_j$，即

$\{L_{cont}\}:(u_i,v_i)\neq(u_j,v_j) \Longrightarrow u_i\neq u_j，v_i\neq v_j$

设$B_1$所在网络存在两个联络点$K_{1i}$和$K_{1j}$，它们通过联络线相关的位于$B_2$所在网络的联络点分别为$K_{2i'}$和$K_{2j'}$，**为表达简洁抽象为下图**，因此联络线为$K_{1i}K_{2i'}$和$K_{1j}K_{2j'}$，设$K_{1j}K_{2i'}$所在直线方程为$l_{K_{1j}K_{2i'}}:f(x,y)=0$，

$f(x,y)=\frac{y-y_{K_{2i'}}}{y_{K_{1j}}-y_{K_{2i'}}}-\frac{x-x_{K_{2i'}}}{X_{K_{1j}}-x_{K_{2i'}}}=0$

为避免联络线重叠，点$A$和$D$应在直线$BC$的两侧，存在约束：

$f(x_{K_{1i}},y_{K_{1i}})\times f(x_{K_{2j'}},y_{K_{2j'}})<0$

![image-20221121150713270](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20221121150713270.png)



（5）调度方案的初步讨论

通过第（4）点的讨论，对整个双供系统的全貌有了更清楚的认识。下面通过一个例子引出调度规则的定义。

![image-20221120195133356](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20221120195133356.png)

非常不幸地，$B_2$电源供电网络发生多处故障，连电源本身也需要故障修复，整个单供网络瘫痪！现通过调度，采取$B_2$电源扩展供电的方式恢复$B_1$网络。一个可行的调度方案为

$断开S_{m1},S_{m2}\rightarrow 隔离K_{21}和故障点$

$闭合S_{c1}\rightarrow K_{21}恢复$

$闭合S_{c2}\rightarrow K_{22},K_{23},K_{24},K_{25}恢复$

观察到，断开本网络开关$S_{m}$，主要为了隔离用户与故障点。因此，当线路故障，断开线路的控制开关；电源故障，断开主线上第一个控制开关；负荷故障，断开负荷前开关。

而闭合联络开关，是为了恢复联络点以及联络点下级线路的供电。调度方案的最后一步可以变为

$闭合S_{c3}\rightarrow K_{24},K_{25}恢复$

这样，$K_{22},K_{23}$的子网络无论是否存在相应的调度方案，都无法恢复，因为没有物理线路的支持！而且这样调度会使得处于上行电路的联络线使用频率变低。因此，**选择故障点后第一个正常联络点**，由于联络点只与一条联络线相关，实际上选择了一条联络线。闭合联络开关，恢复供电。进而得出，**一个具体调度方案是和所使用联络线绑定的**。

回顾第（2）点中的精确用户可靠性概率模型，对于一个用电节点，当存在多条可靠供电路径时如何选择，以上调度规则给出选择优先级。

（6）调度方案的数学表达

在第（5）点的讨论中发现，调度方案实际上是所有开关（包括联络开关$\{S_c\}$和常闭开关$\{S\}$）的状态集合。但为了后面求解算法表达的简便性，本文选择从用户的角度出发定义调度方案。

第（5）点提及，对于一个网络而言，调度方案和联络线相互绑定，也就是两者一一对应。但是，仅仅说明使用哪条联络线并不能具体描述出整个调度方案，因为调度不一定扩供以联络点为根的整个子树，换而言之，处于支线的开关状态还未给出。

为此，定义调度方案扩供的负荷集合为$\{W_i'\}$，因此，调度方案$D_i$定义为

$D_i:(L_{cont_i},\{W_i'\})$

为了表达的简洁性，扩充定义：使用本网络电源正常供电的调度方案为$D_0$.

根据$\{W_i'\}$可以依据以下原则推出常闭开关状态集合$\{S\}$：

若$S_i$所在线路连接的子树中对于$\forall u$均有$u\notin \{W_i\}$，则断开$S_i$，否则将其闭合。

![image-20221121170839589](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20221121170839589.png)

举个例子，闭合$S_c$使用相应联络线进行扩供，但负荷节点$A$，$B$，$C$不在调度集合$\{W_i\}$内，则自下而上地**绿色曲线包裹的区域内**的开关都将断开，若$K_{i+1}$连接所有负荷也不在$\{W_i\}$内，则断开$S_{m(i+1)}$.

（7）电源供电功率的约束

所有调度方案中，必定存在一个用电功率最大的方案。设调度方案集合为$\{D_i\}$，对应扩展用电功率为$P_{D_i}$，最大扩展用电功率为

$P_{max}=max(P_{D_i})$

而每个网络中负荷需求之和为$W_y$，由于电源扩展功率的上限为$50\%$，因此电源供电功率约束为

$P_{D_i}+W_y\leq P_{max}+W_y\leq 1.2W_y\times 150\%$

（8）电源功率的期望

在考察实际电源功率$P_y$，发现在不同调度方案中扩展电源功率并不是一定会产生，而是故障发生后，采取该调度方案后产生的。因此本文通过期望的方式刻画电源功率，并在此基础上考察扩供的花费期望。

定义调度方案$D_i$的使用概率为$P(D=D_i)$，电源功率的期望描述为

$E(P_y)=\sum P_{D_i}\times P(D=D_i)$

实际上，这里定义的$P(D=D_i)$并不容易得到，而前文一直是从负荷视角描述调度方案，**负荷的可靠性增量是由调度带来的！**已知负荷在单供配电网络中的用电可靠性为$r_{0i}$，在给定联络线和调度方案下的可靠性为$r_i'$，显然$r_i'>r_{0i}$，设可靠性增量为$\Delta r=r_i'-r_{0i}$，有

$\sum P_{D_i,y}\times P(D=D_i,y)=\sum r_{0i,y}\times W_{i,y}+\sum \Delta r_{3-y}\times W_{i,3-y}$

$E(P_y)=\sum r_{0i,y}\times W_{i,y}+\sum \Delta r_{3-y}\times W_{i,3-y}$

进一步，电源扩展功率的期望可以表达为
$$
E(P_{y}')=
\left\{  
    \begin{array}{**lr**}
    E(P_y)-1.2W_y, & E(P)\geq 1.2W_y \\  
    0, & E(P)<1.2W_y
    \end{array}  
\right.
$$


（9）双供配电网的建造成本

双供配电网系统的总花费由单供网络各自的建造花费$cost_{y}$，联络线的建造花费$cost_{cont}$，以及扩展功率花费$cost_{pow}$三部分组成，即

$cost_{sum}=\sum cost_{y}+cost_{cont}+cost_{pow}$

第一部分由第（2）问求出，第二部分和其他类型线路的总造价计算方式相同：

$cost_{cont}=cost_{line}+cost_{switch}$

定义距离函数$d:(i,j)\rightarrow R$，有

$d(i,j)=((x_i-x_j)^2+(y_i-y_j)^2)^{\frac{1}{2}}$

对于所有联络线$L_{cont}:(u,v)$，有

$cost_{line}=\sum_{L_{cont}} d(u,v)\times cost_{link}$

$cost_{switch}=2|L_{cont}|$

对于第三部分，根据第（6）点中的讨论，扩展功率花费为

$cost_{pow}=\sum_{y} E(P_y')\times cost_{p,y}$

（10）双供配电网模型

根据问题条件构建目标函数和相应约束条件，

**问题三：**总花费上限为$X$，通过建造联络线，和设计合适的调度方案使得最低的用电可靠性最大，即

$max_{\{L_{cont}\},\{D_i\}}(min(r_i))$

$s.t. cost_{sum}\leq X$

**问题四：**以最低的总费用建造联络线，和设计合适的调度方案使得最低的用电可靠性不低于$Y\%$，即

$min_{\{L_{cont}\},\{D_i\}}(cost_{sum})$

$s.t. min(r_i)\geq Y\%$

其他相同约束：

$$
s.t.
\left\{  
    \begin{array}{**lr**}
    cost_{link}=2cost_{circuit}(1) \\
   	\\
    (u,v)\in \{L_{cont}\}:u\in K_1,v\in K_2 \\
    \\
    r(P_1\cup P_2 \cup ...\cup P_n)=\sum r(P_i)-\sum r(P_i \cap P_j)+...+(-1)^{n-1}r(P_1\cap P_2 \cap ... \cap P_n) \\
    \\
    r_i=r(P_1'\cup P_2' \cup ...\cup P_m') \\
    \\
    \{L_{cont}\}:(u_i,v_i)\neq(u_j,v_j) \Longrightarrow u_i\neq u_j，v_i\neq v_j \\
    \\
    f(x,y)=\frac{y-y_{K_{2i'}}}{y_{K_{1j}}-y_{K_{2i'}}}-\frac{x-x_{K_{2i'}}}{X_{K_{1j}}-x_{K_{2i'}}}=0 \\
    \\
    f(x_{K_{1i}},y_{K_{1i}})\times f(x_{K_{2j'}},y_{K_{2j'}})<0 \\
    \\
    P_{D_i}+W_y\leq 1.2W_y\times 150\% \\
    \\
    E(P_y)=\sum r_{0i,y}\times W_{i,y}+\sum \Delta r_{3-y}\times W_{i,3-y} \\
    \\
    E(P_{y}')=\left\{  
        \begin{array}{**lr**}
        E(P_y)-1.2W_y, & E(P)\geq 1.2W_y \\  
        0, & E(P)<1.2W_y
        \end{array}  
    \right.	\\
    \\
    cost_{sum}=\sum cost_{y}+cost_{cont}+cost_{pow} \\
    \\
    cost_{cont}=cost_{line}+cost_{switch} \\
    \\
    d(i,j)=((x_i-x_j)^2+(y_i-y_j)^2)^{\frac{1}{2}} \\
    \\
    cost_{line}=\sum_{L_{cont}} d(u,v)\times cost_{link} \\
    \\
    cost_{switch}=2|L_{cont}| \\
    \\
    cost_{pow}=\sum_{y} E(P_y')\times cost_{p,y} \\
    \end{array}
\right.
$$





### 模型的求解--双供配电网模型

模型的建立部分详细讨论了决策变量包括联络线$\{L_{cont}\}$的设置以及调度方案$\{D_i\}$和优化目标之间的关系，下面本文将给出如何求解决策变量的思路及方法。

（1）联络线的决策空间

模型建立第（4）点，在讨论联络线约束时设想了一种“全链接”的极端情况，这实际上是联络线在无约束情况下的决策空间的一个解。定义函数$l:K_1\times K_2 \rightarrow L$，该决策空间的数学表达为$L=\{l(u,v)|u\in K_1, v\in K_2\}$，即$L_{cont}\in L$，其大小为$|L|=2^{|K_1|\times|K_2|}$.

联络线的设置集合满足$\{L_{cont}\}\subset L$，进一步，考虑联络线的设置约束<1>，这个约束排除了类似“全链接”的情况，使得$|\{L_{cont}\}|\leq min(|K_1|,|K_2|)$，约束<1>的决策空间设为$L_1$，它可以通过组合方法求解。设有$i$条联络线，满足$i\in[1,min(|K_1|,|K_2|)]$，因此在$K_1$，$K_2$中分别选择$i$个联络点，共$C_{|K_1|}^i\times C_{|K_2|}^i$种情况，$i$对联络点之间相互匹配共$i!$种情况，因此

$|L_1|=\sum_{i=1}^{min(|K_1|,|K_2|)}C_{|K_1|}^i\times C_{|K_2|}^i \times i!$

这里取$|K|=|K_1|=|K_2|$，研究$|L_1|$与$|K|$之间关系，发现$|L_1|$随$|K|$增加呈指数趋势增加，$|K|=13$时，$|L_1|\approx 6.7e7$；$|K|=14$时，$|L_1|\approx 2.8e8$.

![image-20221123162608888](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20221123162608888.png)

更进一步，考虑约束<1><2>的下决策空间$L_2$，由于约束<2>是对分叉点具体坐标关系的限制，该限制强弱难以度量，本文考虑从$L_1$出发，通过约束<2>排除部分决策得到$L_2$.而对于决策空间$L_1$，在$|K|\leq 10$时，可以以遍历该空间的方式获取联络线的设置集合$\{L_{cont}\}$，在此基础上求模型最优解，但是当$|K|>10$时，遍历的时间成本大大增加！

（2）基于启发式准则的贪心算法

既然决策空间至少是$O(2^{|K|})$，无法短时间内遍历，同时，单供网络的几何特征具有不确定性。本文提出基于启发式准则的贪心算法，在面对大规模问题快速求得近似最优解。

**A.算法步骤：**

①初始化$\{L_{cont}\}= \O$；

②对于$\forall (u,v)\in L$，计算$d_{uv}=d(u,v)$，定义矩阵$D=[d_{uv}]_{|K_1|\times|K_2|}$；

对于联络点$u$，定义$u$可扩供的负荷数为$n_u$.

③对于$\forall (u,v)\in L$，计算$n_{uv}=n_u+n_v$，定义矩阵$N=[n_{uv}]_{|K_1|\times|K_2|}$，以及$n_{uv}''=|n_u-n_v|$，定义矩阵$N'=[n_{uv}']_{|K_1|\times|K_2|}$

④求取$i^*,j^*=arg\ minf(\lambda,D_{ij}, N_{ij})$，**其中$f(\lambda,D_{ij}, N_{ij})$为启发式准则**，$\lambda$为协调变量；

⑤若对于$\forall(u,v)\in \{L_{cont}\}$，$(u,v)$和$(i^*,j^*)$均遵循约束<2>，则$\{L_{cont}\}=\{L_{cont}\}\cup(i^*,j^*)$；

⑥$D_{i^*j^*}=\infty$，$N_{i^*j^*}=\infty$；

⑦若$D=[\infty]_{|K_1|\times|K_2|}$，$N=[\infty]_{|K_1|\times|K_2|}$，算法结束，返回联络线设置集合$\{L_{cont}\}$；否则转到④.

**B.启发式准则：**

【1】最优解具有在一定成本下尽可能提升尽可能多的负荷用电可靠性的特征，$\frac{N_{ij}}{D_{ij}}$尽可能大，即

$max(\frac{N_{ij}}{D_{ij}}-c)$

$\iff max(N_{ij}-c\times D_{ij})$

$\iff min(-N_{ij}+c\times D_{ij})$

$\iff min(D_{ij}-\frac{1}{c}N_{ij})$

令$\lambda=\frac{1}{c}$，则$max(\frac{N_{ij}}{D_{ij}}-c) \iff min(D_{ij}-\lambda N_{ij})$.

【2】最优解中，对于联络线$(u,v)$相关的联络点$u$和$v$具有一定的对等性，表现为$u$和$v$可扩供的负荷数之差$|n_u-n_v|$较小，即$min(N_{ij}')$

因此，定义启发式准则为

$f(\lambda,D_{ij}, N_{ij})=D_{ij}-\lambda_1 N_{ij}+\lambda_2 N_{ij}'$

其中，$\lambda_1$和$\lambda_2$为协调变量，用于协调$D$，$N$以及$N'$之间的量纲关系以及权重分配。

（3）负荷分块改进算法

在抽象双供系统网络拓扑的过程中，本文将主线上分叉点$K_i$的支线所连接的子树部分省略（下图绿色曲线包裹部分），原因是对于任意负荷点$A_i$，它和主线上分叉点$K_i$的用电可靠性之比为一个固定常数$c_i$，不会因增设联络线而改变，即$r_{A_i}=c_i\times r_{K_i}$.因此研究时只关注$K_i$，或者说将绿色曲线包裹区域内的负荷视为一个点，用该点（这里是$K_i$）代表该区域内的负荷点，这是一种分块的思想方法。

![image-20221123140248930](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20221123140248930.png)

考虑负荷分块，是因为在贪心方法中可能出现下图情形导致无法增加更多的联络线。拓扑图加入坐标信息，两个单供网络的**主线往相反方向延伸**。运行（2）中算法，步骤⑤第一个加入$\{L_{cont}\}$的联络线为$(K_1,K_2)$，其中$K_1,K_2=arg\ min(D_{ij}-\lambda_1 N_{ij}+\lambda_2 N_{ij}')$，之后产生的联络线$(u,v)$和$(K_1,k_2)$均不能满足约束<2>，因为$(K_1,K_2)$恰好将两个单供网络剩余分叉点分割为2个集合！设为$S=\{u\in \{K_{B_1}\}/\{K_1\}\}$以及$T=\{v\in \{K_{B_2}\}/\{K_2\}\}$，如图，将不会有新联络线$(K_i,K_j)$被应用！

![image-20221123154025865](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20221123154025865.png)

这实际上归因于贪心算法并未考虑约束<2>带来的影响，因此，本文提出以下**负荷分块改进算法**：

①对主线上连续$k$个分叉点$K_j$，$K_{j+1}$，...，$K_{j+k}$，构造一个虚拟点$K_i'$，其中$x_{K_i'}=\frac{1}{k}\sum_{j}^k x_{K_j}$，$y_{K_i'}=\frac{1}{k}\sum_{j}^k y_{K_j}$，设该双供系统虚拟点的集合为$\{K_{i',y}\}$，$y\in \{1,2\}$代表两个单供网络，$\{K_{i',y}\}$和电源$B_1$，$B_2$构成一个虚拟双供系统；

②求该虚拟系统联络线设置集合$\{L_{cont}\}^*$，满足$|\{L_{cont}\}^*|=max(|\{L_{cont}\}|)$；

③对于$\forall (K_i',K_j')\in \{L_{cont}\}^*$，对$K_i'$对应的真实分叉点集合$\{K_i,K_{i+1},...,K_{i+k}\}$以及$K_j'$对应的分叉点集合$\{K_j,K_{j+1},...,K_{j+k}\}$应用基于启发式准则的贪心算法。

该算法保证了联络线的数量，因为$\forall (K_i',K_j')$之间满足约束<2>，对应真实分叉点集合至少存在一对点满足约束<2>，最终联络线设置集合满足$|\{L_{cont}\}|\geq |\{L_{cont}\}^*|$.

对上述例子应用该算法，取$k=2$：

①构造虚拟点$K_i'$：![image-20221123173603500](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20221123173603500.png)

②求虚拟系统联络线设置集合$\{L_{cont}\}^*$：

![image-20221123174436567](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20221123174436567.png)

③对$K_i'$和$K_j'$对应的真实分叉点集合应用贪心算法：

![image-20221123191720760](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20221123191720760.png)

（4）两级最小堆求解调度方案$\{D_i\}$

在联络线设置集合$\{L_{cont}\}$确定后，我们考虑求解调度方案$\{D_i\}$.问题三要求求解$\{D_i\}$使得最低的用电可靠性最大，问题四要求使得可靠性不低于$Y\%$，最终的调度方案$\{D_i\}$是在约束条件下逐步优化而来，而两问中每一步优化可以均是优化用电可靠性最低的负荷。动态维护最小值，容易想到堆结构，针对问题特点，本文提出基于两级最小堆的方案：

①对主线上每个分叉点$K_i$维护最小堆$heap[K_i]$，存储$K_i$支线所连接子树中所有负荷点，堆以负荷用电可靠性为键建立，访问可获取负荷相关编号等相关信息，通过结构体重载运算符实现；

②将所有分叉点最小堆$heap[K_i]$的堆顶元素$heap[K_i].top$加入到全局最小堆$heap_{global}$中，并增加堆号标识$K_i$；

③单步更新方案：获取$heap_{global}.top$，弹出，访问获取对应堆号标识$K_i$，推知$heap_{global}.top==heap[K_i].top$，弹出，为负荷增加扩供线路，优化其用电可靠性，更新节点为$node_{new}$，将$node_{new}$加入$heap[K_i]$，将$heap[K_i]$加入$heap_{global}$，同时以差量方式更新电源功率$ E(P_y)=E(P_y)-E(node_{old})+E(node_{new})$，根据公式$()()$进一步更新$cost_{pow}$.

④算法结束条件：调度方案饱和或者下一步优化调度不满足电源供电功率$1.2W_y\times 150\%$的约束.

![image-20221123195902576](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20221123195902576.png)

该方案的现实意义在于对整个双供系统进行层次分级，设立不同层次的中心点收集局部信息，通过中心点将信息逐层向上汇聚，最终获得全局信息的摘要，以进行全局规划。

该方案对最小值单步更新没有明显影响，时间复杂度仍为$O(log(\sum|K_i|))$，实际上堆中的每棵子树均满足根节点键最大的性质，或者说每棵子树均是一个子堆，而该方案将一个堆拆为多个子堆，并没有改变堆的结构，自然对操作的时间复杂性没有影响。

（5）问题三的求解

约束条件转化为

$cost_{cont}+cost_{pow}=cost_{sum}-\sum cost_{y}\leq X-\sum cost_{y}$

设联络线建设花费与扩供花费比例为$\frac{\gamma}{1-\gamma}$，可得
$$
\left\{  
        \begin{array}{**lr**}
        cost_{cont}\leq \gamma \times (X-\sum cost_{y}) \\
        cost_{pow}\leq (1-\gamma) \times (X-\sum cost_{y})
        \end{array}  
    \right.	\\
$$
以$\Delta\gamma=0.02$单步长遍历$\gamma$，应用负荷改进后的贪心算法求解联络线设置集合$\{L_{cont}\}$，对每次更新$\{L_{cont}\}=\{L_{cont}\}\cup(i^*,j^*)$，同时更新$cost_{cont}=cost_{cont}+cost(i^*,j^*)$，增加算法结束条件：$cost_{cont}+cost(i^*,j^*)> \gamma \times (X-\sum cost_{y})$.

应用两级最小堆求解调度方案$\{D_i\}$，每步优化同时更新$cost_{pow}=cost_{pow}+(\Delta r\times W_i)\times cost_{p,y}$，增加算法结束条件$ cost_{pow}+\Delta cost> (1-\gamma) \times (X-\sum cost_{y})$.

最终结果取$max_{\gamma}(maxmin(r_i))$.

（6）问题四的求解

应用负荷改进后的贪心算法，对每次更新得到的$\{L_{cont}\}$，应用两级最小堆求解调度方案$\{D_i\}$，增加算法结束条件单步更新的优化目标$node$满足$r(node)\geq Y\%$.

最终结果取$min_{\{L_{cont}\},\{D_i\}}(cost_{cont}+cost_{pow})$.



### 结果分析

（1）联络线设置集合$\{L_{cont}\}$

在第2题结果的基础上，取分块大小$k=3$运行负荷改进后的贪心算法，算法依次建立联络线$(2,8)$，$(4,9)$，$(5,10)$，如下图

![image-20221125010702825](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20221125010702825.png)

可以看到，联络线设置集合$\{L_{cont}\}=\{(2,8),(4,9),(5,10)\}$将两个单供网络紧紧联系，同时满足联络线设置的约束。算法运行过程中联络线设置集合$\{L_{cont}\}$以及相应建设花费$cost_{cont}$变化如下表，可以观察到建设花费增量$δ$在不断增加，符合贪心原则的结果。

| **联络线设置集合$\{L_{cont}\}$** | **建设花费$cost_{cont}$（千元）** | **增量$δ$（千元）** |
| :------------------------------: | :-------------------------------: | :-----------------: |
|           **$\{∅\}$**            |               **0**               |        **0**        |
|         **$\{(2,8)\}$**          |          **593.117404**           |   **593.117404**    |
|      **$\{(2,8),(4,9)\}$**       |          **1487.211164**          |    **894.09376**    |
|   **$\{(2,8),(4,9),(5,10)\}$**   |          **2611.857373**          |   **1124.646209**   |

记上表中建设花费一列为$cost_{cont}=[594;1488;2612]$，问题三对于给定$X$，可令$\gamma \times (X-\sum cost_{y})=cost_{cont}(i),i=0,1,2,3$，进行下面调度方案$\{D_i\}$的求解.

（2）调度方案$\{D_i\}$

运行两级最小堆方案，进行多轮优化，结果如下表。在弱化约束条件的基础上，每轮优化的目标负荷所在分块由于局部性集中在主线的末端，而每次优化带来的可靠性增量在$0.1\%-0.5\%$内，最低可靠性在$96\%-97\%$的水平。

| 优化轮数(t) | 优化负荷所在分块($K_i$) | 优化前的可靠性(×100%) | 优化后的可靠性(×100%) | 可靠性增量δ(×100%) |
| ----------- | ----------------------- | --------------------- | --------------------- | ------------------ |
| 1           | 6                       | 0.968026              | 0.969213              | 0.001187           |
| 2           | 6                       | 0.968174              | 0.969361              | 0.001187           |
| 3           | 6                       | 0.969213              | 0.971051              | 0.001838           |
| 4           | 6                       | 0.969361              | 0.971199              | 0.001838           |
| 5           | 6                       | 0.969821              | 0.97101               | 0.001189           |
| 6           | 6                       | 0.969889              | 0.971078              | 0.001189           |
| 7           | 6                       | 0.970041              | 0.97123               | 0.001189           |
| 8           | 6                       | 0.970042              | 0.971231              | 0.001189           |
| 9           | 6                       | 0.970285              | 0.971475              | 0.00119            |
| 10          | 6                       | 0.97101               | 0.97285               | 0.00184            |
| 11          | 6                       | 0.971051              | 0.975321              | 0.00427            |
| 12          | 6                       | 0.971078              | 0.972919              | 0.001841           |
| 13          | 6                       | 0.971199              | 0.975469              | 0.00427            |
| 14          | 6                       | 0.97123               | 0.973071              | 0.001841           |
| 15          | 6                       | 0.971231              | 0.973072              | 0.001841           |
| 16          | 6                       | 0.971475              | 0.973316              | 0.001841           |
| 17          | 6                       | 0.97285               | 0.977128              | 0.004278           |
| 18          | 6                       | 0.972919              | 0.977197              | 0.004278           |
| 19          | 6                       | 0.973071              | 0.97735               | 0.004279           |
| 20          | 6                       | 0.973072              | 0.977351              | 0.004279           |
| 21          | 5                       | 0.973231              | 0.974424              | 0.001193           |
| 22          | 6                       | 0.973316              | 0.977596              | 0.00428            |
| 23          | 5                       | 0.973329              | 0.974522              | 0.001193           |
| 24          | 5                       | 0.973383              | 0.974576              | 0.001193           |
| 25          | 5                       | 0.973481              | 0.974675              | 0.001194           |
| 26          | 11                      | 0.973065              | 0.976951              | 0.003886           |
| 27          | 11                      | 0.973094              | 0.97698               | 0.003886           |
| 28          | 5                       | 0.974424              | 0.976271              | 0.001847           |
| 29          | 5                       | 0.974522              | 0.976369              | 0.001847           |
| 30          | 5                       | 0.974576              | 0.976424              | 0.001848           |
| 31          | 5                       | 0.974675              | 0.976522              | 0.001847           |





