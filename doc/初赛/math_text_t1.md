**分叉点构造：**
[1] 对最小生成树中原先作为分枝点的负荷节点 $A_i$，在其附近构造一个分叉点 $A_i'$ ;
[2] 删除节点 $A_i$ 的邻接线路 $\{A_iB_j|j=1,2,...\}$ ;
[3] 增加线路 $A_iA_i'$ 以及分叉点 $A_i'$ 的邻接线路 $\{A_i'B_j|j=1,2,...\}$ ;

设树状配电网的邻接矩阵为 $G$ ，电源为 $bat$ ，分叉点集合为 $B=\{b_i|i=1,2,...,n_b\}$ ，叶子集合为 $L=\{l_i|i=1,2,...,n_l\}$ 。

设节点 $i$ 的所在子树的负荷数为 $load[i]$ ，由邻接矩阵 $G$ 从根节点 $bat$ 出发深度优先搜索可以求得每个节点 $i$ 的儿子节点集合，设为 $son_i=\{s_{ij}|j=1,2,...,n_i\}$ ，以及其父亲节点 $fa_i$ 由递推公式
$$
load[i]=
\begin{cases}
1,& \text{ $i\in{L}$ } \\
\sum_{s_{ij}\in{son_i}}{load[s_{ij}]},& \text{ $i\in{B}$ }
\end{cases}
$$
求得 $load[i]$ ，此时可以确定所有线路的选型，对于节点 $i$ ，我们考察线路 $(i,fa_i)$，即 $ifa_i$，设其线型为 $type(ifa_i)$，有
$$
type(ifa_i)=
\begin{cases}
1(主线),& \text{ $fa_i=bat$ } \\
2(支线A),& \text{ $load[i]\leq2$ } \\
3(支线B),& \text{ $load[i]>2$ }
\end{cases}
$$

设线路单价向量为 $cost_{circuit}$ ,开关单价向量为 $cost_{switch}$ ,线路长度向量为 $length$ ,开关数量向量为 $num$ 。根据题目提供的数据得
$$ cost_{circuit} = (325.7 \quad 188.6 \quad 239.4)\\
cost_{switch} = (2.6 \quad 58.6)
$$
为确定 $length$ ，我们引入决策变量——分叉点的坐标，设为 $\{(x_i,y_i)|i\in{B}\}$ ，同时根据假设1“负荷均匀、随机地分布于一定区域，并且电源位于区域的中心”构造测试数据集，其中设负荷坐标为 $\{(x_i,y_i)|i\in{L}\}$，电源坐标为 $\{(x_i,y_i)|i\in{bat}\}$ 。使用欧式距离公式计算节点之间的距离，设节点 $i,j$ 之间的距离为
$$dis(i,j)=\sqrt{(x_i-x_j)^2+(y_i-y_j)^2}$$
由此确定
$$ length(k)=\sum_{G(i,j)=1\ 且\ type(i,j)=k}{dis(i,j)},k=1,2,3 $$
而开关数量向量的确定，容易知道每个负荷前有一个负荷前开关，每个分叉点（包括电源）后有一个主线开关，推得 $num=(n_l,n_b)$ 。
因此，线路建造费用总和为
$$ cost_{sum}=cost_{circuit}*length+cost_{switch}*num $$


设节点 $i$ 的用电可靠性为 $r[i]$ ，已知其父亲节点为 $fa_i$，有
$$ r[i]=r[fa_i]*(1-0.5\%)*(1-0.2\%)*(1-0.002*dis(i,fa_i)) $$
类似于 $load[i]$ ，上式可通过深度优先搜索的过程中递推计算，最终 $\{r[i]|i\in{L}\}$ 为用户用电可靠性。


问题一要求建造费用最低的单供配电网供电所有用户，基于最小生成树算法我们进行设计了以电源为根节点的辐射式树状结构，满足了供电所有用户的需求，并且优良的拓扑结构上为减少支出打下基础。之后，引入决策变量——分叉点的坐标 $\{(x_i,y_i)|i\in{B}\}$，量化描述线路造价，建立基于单目标优化的单供配电网模型。
**目标函数**：最小化线路建造费用，即 $min(cost_{sum})$ ，由于开关部分花费在拓扑结构确定后也确定，式子进一步简化为 $min(cost_{circuit}*length)$。
**约束条件**:
a) 配电网是以电源为根节点的树状结构；
b) 开关设置原则以及安培限流；
c) 线路安培限流；
以上约束通过构造性算法得以满足，因此最后得到的实际是无约束模型。

综上所述，建立单目标优化模型。
$$ min(cost_{circuit}*length) $$
$$
\begin{cases}
load[i]=
\begin{cases}
1,& \text{ $i\in{L}$ } \\
\sum_{s_{ij}\in{son_i}}{load[s_{ij}]},& \text{ $i\in{B}$ }
\end{cases} \\
\\
type(ifa_i)=
\begin{cases}
1(主线),& \text{ $fa_i=bat$ } \\
2(支线A),& \text{ $load[i]\leq2$ } \\
3(支线B),& \text{ $load[i]>2$ }
\end{cases} \\
\\
dis(i,j)=\sqrt{(x_i-x_j)^2+(y_i-y_j)^2} \\
\\
length(k)=\sum_{G(i,j)=1\ 且\ type(i,j)=k}{dis(i,j)},k=1,2,3 \\
\\
r[i]=r[fa_i]*(1-0.5\%)*(1-0.2\%)*(1-0.002*dis(i,fa_i))
\end{cases}
$$

